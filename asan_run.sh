#! /bin/bash

p=$(pwd)
h=$(echo $HOME)

if [ "$1""x" == "buildx" ]; then
  cp -av resources/common/libffmpeg_av_jni.so__ASAN resources/common/libffmpeg_av_jni.so
  cp -av resources/common/libjni-c-toxcore.so__ASAN resources/common/libjni-c-toxcore.so
  ./gradlew -Dorg.gradle.java.home=/usr/lib/jvm/java-17-openjdk-amd64/ packageDistributionForCurrentOS
  ./gradlew -Dorg.gradle.java.home=/usr/lib/jvm/java-17-openjdk-amd64/ packageUberJarForCurrentOS
fi

LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libasan.so.6.0.0 \
/usr/lib/jvm/java-17-openjdk-amd64/bin/java -Dapple.awt.application.name=TRIfA \
-Dcom.apple.mrj.application.apple.menu.about.name=TRIfA -Dcompose.application.configure.swing.globals=true -Dcompose.application.resources.dir="$p"/build/compose/tmp/prepareAppResources -Dfile.encoding=UTF-8 -Duser.country=US -Duser.language=en -Duser.variant \
-cp "$p"/build/compose/jars/trifa_material-linux-x64-1.0.11.jar \
MainKt

# -cp "$p"/build/libs/trifa_material-1.0.8.jar:\
# "$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.desktop/desktop-jvm/1.6.0-dev1347/f640e39ac0a51a00f788a0cc8ac1107fdc9a528f/desktop-jvm-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.material/material-desktop/1.6.0-dev1347/37f5fbfd7f792902ed6b5bf7f8ad0679b7770bba/material-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.components/components-resources-desktop/1.6.0-dev1347/bc53fa14f4ece5f8be90a899ef59152df7601ca/library-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.material3/material3-desktop/1.6.0-dev1347/c4f78e20d9bea223397212b80145934dc9507f76/material3-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.material/material-ripple-desktop/1.6.0-dev1347/73de6da196c34db3e71935baf37d6b6734eea6f6/material-ripple-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.foundation/foundation-desktop/1.6.0-dev1347/f4098f54feb3fe99e67eab4d48cbd43241644152/foundation-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.material/material-icons-extended-desktop/1.6.0-dev1347/20da10db08144f8020231ba2e48b4e1c34f913cd/material-icons-extended-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/io.github.alexzhirkevich/qrose-desktop/1.0.0-beta3/68deae874be302338efbf8c0cd4d1b2b97c495f/qrose-desktop-1.0.0-beta3.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.animation/animation-desktop/1.6.0-dev1347/da5a9e417f2cc10cc9840e4b66fb3fa1f09daca2/animation-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.foundation/foundation-layout-desktop/1.6.0-dev1347/312976986a73c70255570e5bfbc51847c0059baa/foundation-layout-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.animation/animation-core-desktop/1.6.0-dev1347/19c476a09cc66652fe69b9064f3a77c894e188c3/animation-core-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.material/material-icons-core-desktop/1.6.0-dev1347/30a5b7bdb98c19105b3bffb44f9d7591159e546c/material-icons-core-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.ui/ui-desktop/1.6.0-dev1347/2a9039f474df3ee61cfbe4c25afb22b86f481fb1/ui-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.ui/ui-tooling-preview-desktop/1.6.0-dev1347/62232c44c61692b56d3071c29b0f9c8481b20574/ui-tooling-preview-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.ui/ui-text-desktop/1.6.0-dev1347/d4334c70a8f05790c0e04069522ef4ac5b5847dc/ui-text-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.runtime/runtime-saveable-desktop/1.6.0-dev1347/88cee67f1f9b135321745f0f470e0c3f2c456cbc/runtime-saveable-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.ui/ui-graphics-desktop/1.6.0-dev1347/a775f10d95051b85eb468a5240495cfdaf483a67/ui-graphics-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.ui/ui-unit-desktop/1.6.0-dev1347/73a81fa29b6859c388996d3a2865206756aedc1a/ui-unit-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.ui/ui-geometry-desktop/1.6.0-dev1347/67678193a2f7e0cb1f8a899ae5de229bee3a30dc/ui-geometry-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.runtime/runtime-desktop/1.6.0-dev1347/14406b2d2a9e7a32b8f0b733d0d0eb6674f36896/runtime-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.skiko/skiko-awt-runtime-linux-x64/0.7.90/61a017dce555364c5dfeb7dde616bbe4414d6005/skiko-awt-runtime-linux-x64-0.7.90.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.skiko/skiko-awt/0.7.90/99e533b9554bdb885846c28a4d805325d711e32f/skiko-awt-0.7.90.jar:"$h"/.gradle/caches/modules-2/files-2.1/ca.gosyer/kotlin-multiplatform-appdirs-jvm/1.1.1/a8b92433066050fc0c0840185fde18c741aab4ce/Kotlin-Multiplatform-AppDirs-jvm-1.1.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.compose.ui/ui-util-desktop/1.6.0-dev1347/82fadb7456a2328ac783c2a3b93641fbfe416dde/ui-util-desktop-1.6.0-dev1347.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlinx/atomicfu-jvm/0.23.1/a4601dc42dceb031a586058e8356ff778a57dea0/atomicfu-jvm-0.23.1.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlin/kotlin-stdlib-jdk8/1.9.21/290a25c998941b1c904d2cef480fd56be7ae9d7/kotlin-stdlib-jdk8-1.9.21.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlinx/kotlinx-coroutines-core-jvm/1.8.0-RC/66f50b3d0f13b1fba29e99a06111626a962061fa/kotlinx-coroutines-core-jvm-1.8.0-RC.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlin/kotlin-stdlib-jdk7/1.9.21/2d2c2b1d441e48ed37383e42f133339691436425/kotlin-stdlib-jdk7-1.9.21.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlinx/kotlinx-datetime-jvm/0.5.0/8882b30187d18d2dcb5e22587447485e6f42dfb3/kotlinx-datetime-jvm-0.5.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains.kotlin/kotlin-stdlib/1.9.21/17ee3e873d439566c7d8354403b5f3d9744c4c9c/kotlin-stdlib-1.9.21.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.xerial/sqlite-jdbc/3.44.1.0/12e6182deef32d366ade664aa33bec9f4dd3ffe/sqlite-jdbc-3.44.1.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.sksamuel.scrimage/scrimage-webp/4.1.1/9452b5920cb0536b5dfc9adddf4ed0af1ce25c31/scrimage-webp-4.1.1.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.sksamuel.scrimage/scrimage-core/4.1.1/33b6fa2cc5d6d872f8de4d93528d978aeb3416d7/scrimage-core-4.1.1.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.google.code.gson/gson/2.10.1/b3add478d4382b78ea20b1671390a858002feb6c/gson-2.10.1.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.jetbrains/annotations/23.0.0/8cc20c07506ec18e0834947b84a864bfc094484e/annotations-23.0.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.github.zh79325/open-gif/1.0.4/a52a4183dae721cb69dd1fcd4ef34b0bb72d7698/open-gif-1.0.4.jar:"$h"/.gradle/caches/modules-2/files-2.1/ch.qos.logback/logback-classic/1.1.2/b316e9737eea25e9ddd6d88eaeee76878045c6b2/logback-classic-1.1.2.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.slf4j/slf4j-api/2.0.6/88c40d8b4f33326f19a7d3c0aaf2c7e8721d4953/slf4j-api-2.0.6.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.twelvemonkeys.imageio/imageio-jpeg/3.9.4/af05e039169ab2d42efde9070f55565a169f795d/imageio-jpeg-3.9.4.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.twelvemonkeys.imageio/imageio-metadata/3.9.4/423ab3a09a87ab0b1e6831269db74832ee4184ac/imageio-metadata-3.9.4.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.twelvemonkeys.imageio/imageio-core/3.9.4/e33aabf2d21a2f66817a258abfcd9f5b1e898117/imageio-core-3.9.4.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.drewnoakes/metadata-extractor/2.18.0/fa9fd43a28b10333108c603819810d5176d2b092/metadata-extractor-2.18.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/commons-io/commons-io/2.11.0/a2503f302b11ebde7ebc3df41daebe0e4eea3689/commons-io-2.11.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/ar.com.hjg/pngj/2.1.0/b9a0d5cca5108431c4068976e795d4d2766dab5b/pngj-2.1.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/org.apache.commons/commons-lang3/3.12.0/c6842c86792ff03b9f1d1fe2aab8dc23aa6c6f0e/commons-lang3-3.12.0.jar:"$h"/.gradle/caches/modules-2/files-2.1/net.java.dev.jna/jna-platform/5.12.1/97406a297c852f4a41e688a176ec675f72e8329/jna-platform-5.12.1.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.twelvemonkeys.common/common-image/3.9.4/8fc121f4f652cb8ef626ad4dade85b64948df36c/common-image-3.9.4.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.twelvemonkeys.common/common-io/3.9.4/5a0bbb2f431196990780a4912f0ac46009c82f0e/common-io-3.9.4.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.twelvemonkeys.common/common-lang/3.9.4/c68d7dd18962dda58615d3b5d929a68c8f8a1092/common-lang-3.9.4.jar:"$h"/.gradle/caches/modules-2/files-2.1/com.adobe.xmp/xmpcore/6.1.11/852f14101381e527e6d43339d7db1698c970436c/xmpcore-6.1.11.jar:"$h"/.gradle/caches/modules-2/files-2.1/ch.qos.logback/logback-core/1.1.2/2d23694879c2c12f125dac5076bdfd5d771cc4cb/logback-core-1.1.2.jar:"$h"/.gradle/caches/modules-2/files-2.1/net.java.dev.jna/jna/5.12.1/b1e93a735caea94f503e95e6fe79bf9cdc1e985d/jna-5.12.1.jar \
# MainKt

